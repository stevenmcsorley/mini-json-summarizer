<source>
  @type forward
  port 24224
  bind 0.0.0.0
</source>

# Store logs in memory buffer with 5-minute window
<match app.**>
  @type file
  path /fluentd/log/app
  append true

  <format>
    @type json
  </format>

  <buffer>
    @type file
    path /fluentd/log/buffer
    flush_mode interval
    flush_interval 10s
    chunk_limit_size 5MB
  </buffer>
</match>

# HTTP endpoint to retrieve logs
<source>
  @type http
  port 9880
  bind 0.0.0.0
</source>

# Forward logs to stdout for debugging
<match app.**>
  @type copy
  <store>
    @type stdout
  </store>
</match>
